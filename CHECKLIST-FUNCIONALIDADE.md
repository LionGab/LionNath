# ‚úÖ Checklist: Deixar o App Funcional

## ‚úÖ Problemas Corrigidos

### 1. ‚úÖ Arquivo .env.local criado
- Criado arquivo `.env.local` com todas as vari√°veis de ambiente necess√°rias
- Configurado com credenciais do Supabase
- Adicionado GEMINI_API_KEY

### 2. ‚úÖ OnboardingScreen corrigido
- **Problema:** Ap√≥s criar usu√°rio no Supabase, o `userId` n√£o era salvo no AsyncStorage
- **Solu√ß√£o:** Adicionado `await AsyncStorage.setItem('userId', user.id);` ap√≥s criar o perfil
- **Impacto:** Agora o chat e outras funcionalidades conseguem identificar o usu√°rio corretamente

---

## ‚ö†Ô∏è Configura√ß√µes Necess√°rias (Manual)

### 1. Supabase Database Schema
O schema do banco de dados precisa ser executado no Supabase:

1. Acesse: https://supabase.com/dashboard
2. V√° em **SQL Editor**
3. Execute o arquivo: `supabase/schema-nossa-maternidade-completo.sql`
   - Ou use `SCHEMA_COMPLETO_FINAL.sql` na raiz

**Tabelas necess√°rias:**
- `user_profiles` - Perfis de usu√°rios
- `chat_messages` - Mensagens do chat
- `daily_plans` - Planos di√°rios

### 2. Supabase Edge Function Secrets
A Edge Function `nathia-chat` precisa da chave do Gemini:

1. Acesse: https://supabase.com/dashboard
2. V√° em **Edge Functions > Secrets**
3. Adicione:
   - **Nome:** `GEMINI_API_KEY`
   - **Valor:** `AIzaSyC9YVWRmnGyGu4c9y7g-mNkkipDqb5JBZg`

### 3. Deploy Edge Function (se necess√°rio)
Se a Edge Function n√£o estiver deployada:

```bash
supabase functions deploy nathia-chat
```

Ou via Supabase Dashboard:
1. Edge Functions > Deploy

---

## üß™ Como Testar

### 1. Instalar depend√™ncias (se necess√°rio)
```bash
npm install
```

### 2. Iniciar o app
```bash
npm start
# ou
expo start
```

### 3. Fluxo de teste:

1. **Onboarding:**
   - O app deve abrir na tela de onboarding
   - Preencher os dados (nome, tipo, semana, prefer√™ncias)
   - Ao finalizar, deve navegar para a Home

2. **Home Screen:**
   - Deve mostrar o nome do usu√°rio
   - Bot√µes de a√ß√£o r√°pida funcionando
   - Possibilidade de gerar plano di√°rio

3. **Chat Screen:**
   - Enviar mensagem
   - Deve receber resposta da IA (via Edge Function ou fallback)
   - Hist√≥rico deve ser carregado

4. **Plano Di√°rio:**
   - Gerar plano di√°rio
   - Deve salvar no Supabase
   - Deve aparecer na Home tamb√©m

---

## üîç Verifica√ß√µes Importantes

### Vari√°veis de Ambiente
Verifique se o arquivo `.env.local` existe e tem:
- ‚úÖ `EXPO_PUBLIC_SUPABASE_URL`
- ‚úÖ `EXPO_PUBLIC_SUPABASE_ANON_KEY`
- ‚úÖ `EXPO_PUBLIC_GEMINI_API_KEY`

### AsyncStorage
O app salva:
- `onboarded` - Se o usu√°rio completou onboarding
- `userId` - ID do usu√°rio no Supabase
- `userProfile` - Perfil completo do usu√°rio

### Supabase
Verifique se:
- ‚úÖ Tabelas criadas (`user_profiles`, `chat_messages`, `daily_plans`)
- ‚úÖ RLS (Row Level Security) configurado
- ‚úÖ Edge Function `nathia-chat` deployada
- ‚úÖ Secret `GEMINI_API_KEY` configurado

---

## üêõ Problemas Conhecidos / Limita√ß√µes

1. **Autentica√ß√£o tempor√°ria:**
   - O onboarding cria usu√°rios com email/senha tempor√°rios
   - Idealmente deveria usar autentica√ß√£o an√¥nima ou melhorar este fluxo

2. **Fallback de IA:**
   - Se a Edge Function falhar, usa Claude como fallback
   - Requer `EXPO_PUBLIC_CLAUDE_API_KEY` configurada (opcional)

3. **Valida√ß√£o de API Keys:**
   - O app n√£o valida se as chaves est√£o configuradas na inicializa√ß√£o
   - Erros aparecem apenas quando tenta usar

---

## üìù Pr√≥ximos Passos Recomendados

1. **Melhorar autentica√ß√£o:**
   - Implementar autentica√ß√£o an√¥nima ou melhorar o fluxo atual
   - Adicionar valida√ß√£o de email/telefone

2. **Valida√ß√£o de configura√ß√£o:**
   - Adicionar tela de verifica√ß√£o de configura√ß√£o na inicializa√ß√£o
   - Mostrar warnings claros se chaves estiverem faltando

3. **Error handling:**
   - Melhorar tratamento de erros de conex√£o
   - Adicionar retry autom√°tico para opera√ß√µes cr√≠ticas

4. **Testes:**
   - Adicionar testes unit√°rios para hooks cr√≠ticos
   - Testes de integra√ß√£o para fluxos principais

---

## ‚úÖ Status Final

- ‚úÖ C√≥digo corrigido (OnboardingScreen)
- ‚úÖ Arquivo .env.local criado
- ‚ö†Ô∏è Configura√ß√£o manual do Supabase necess√°ria
- ‚ö†Ô∏è Deploy da Edge Function pode ser necess√°rio

**O app deve estar funcional ap√≥s as configura√ß√µes manuais do Supabase!**
